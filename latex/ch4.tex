\chapter{Resultados y discusión}
En este capítulo se presentan los resultados obtenidos tras las simulaciones en forma de cortes bidimensionales de una simulación tridimensional que se presenta como una animación GIF. En un primer apartado se muestran las imágenes correspondientes al espectro de potencias primordial \(\symrm{P}_0(k)\) ---puramente proporcional a \(k^{n_s}\). En el segundo punto del capítulo, se observan las simulaciones con la función de transferencia~\eqref{eq::transff} que son más acordes a las fluctuaciones del fondo cósmico de microondas, ya que se tiene en cuenta cierta evolución gravitatoria en las perturbaciones. En la última sección se añade un código QR para visualizar el campo tridimensional. Todos los resultados tienen como entrada los mismos números aleatorios, haciendo posible la comparación entre ellos.

En primer lugar para el espectro de potencias primordial \(\symrm{P}_0(k)\):
\begin{itemize}
    \item \(n_s=0\). Ruido blanco, el fondo sobre el que se perturba. Sirvió para comprobar el funcionamiento.
    \item \(n_s=1\). Harrison-Zel'dovich. Grandes escalas, se utilizó para comprobar un espectro \textit{blue-biased} \((n_s>0)\) que se refiere a un espectro dominado por los números de onda grandes, esto son longitudes de onda pequeñas (azul). Fluctuaciones de menor tamaño físico.
    \item \(n_s=-3\). Pequeñas escalas del universo, sirvió para comprobar un espectro \textit{red-biased} \((n_s<0)\) que es la contraparte del anterior, donde las longitudes de onda largas (rojo) contribuyen más, es decir, fluctuaciones de mayor tamaño físico.
\end{itemize}
Y al final, para la simulación más realista se utilizó~\eqref{eq::espectrolineal} y~\eqref{eq::transff}:
\begin{itemize}
    \item \(n_s=5\). En este caso, \(P(k)\propto k\) que corresponde a grandes escalas y ha de ser homogéneo con pequeñas fluctuaciones.
    \item \(n_s=0.965\). Es el que se observa experimentalmente, apunta a escalas más pequeñas donde las fluctuaciones son más grandes y ha de ser visualmente similar al CMB.
\end{itemize}

En las figuras se están representando, tanto en el eje horizontal como en el vertical, distancias medidas en Mpc. La barra de color indica los valores que toma el campo de fluctuaciones de densidad de energía para un tiempo fijo, \(\delta(\symbf{x})\). Se utiliza el código de colores del CMB en orden a interpretar mejor las imágenes:
\begin{itemize}
    \item El color blanco ---siempre centrado--- representa \(\delta(\symbf{x})=0\) que, de acuerdo a~\eqref{eq::campofluct}, significa que la densidad de energía en ese punto \(\rho(\symbf{x})\) es igual a la densidad del fondo homogéneo \(\overbar{\rho}\). No hay fluctuación.
    \item El color rojo es para fluctuaciones positivas \(\rho(\symbf{x})>\overbar{\rho}\).
    \item El color azul es para fluctuaciones negativas \(\rho(\symbf{x})<\overbar{\rho}\).
\end{itemize}
Mediante la función \texttt{numpy.clip}, el campo final que se genera es para todo \(\symbf{x}\) (por requisito físico \(\rho(\symbf{x})\geq 0\)) mayor o igual que -1 (\(\delta(\symbf{x})\geq -1\)). El parámetro del modelo \(A_0\) se adecúa en cada caso para dar lugar a \(\delta(\symbf{x})\sim 10^{-5}\), valor que aparece en las anisotropías del CMB.

A continuación, se muestra en la~\autoref{fig::ejemplo} un ejemplo de las imágenes que se obtienen. Cada píxel es un cuadrado de lado \(L\) megapársecs, cuyo color representa el valor de \(\delta(\symbf{x})\) y donde el número de píxeles de la imagen está parametrizado con la variable \(N\) (véase~\autoref{ch::mym}).
\begin{figure}[h!]
    \centering
    \scalebox{.99}{\input{pgf/ejemplo.pgf}}
    \caption[Ejemplo de un campo gaussiano aleatorio]{Ejemplo de un campo gaussiano aleatorio con \(L=1\) Mpc/píxel y \(A_0=1\symrm{E}{-14}\) Mpc\textsuperscript{3}. Ampliado a escala de 1 píxel.}
    \label{fig::ejemplo}
\end{figure}
\section{Campos gaussianos con espectro de potencias primordial}
\subsection{Ruido blanco (\texorpdfstring{\(n_s=0\)}{ns=0})}
En este escenario, el espectro de potencias es constante. Esto significa que para cualquier valor de \(k\), según~\eqref{eq::relation}, no existe correlación entre las fluctuaciones de densidad de diferentes puntos del espacio real, es decir, ningún tamaño es privilegiado en las fluctuaciones que aparecen. El correspondiente \(\delta(\symbf{x})\) tiene un aspecto de ``ruido'' donde todas las frecuencias espaciales aportan (igual que la luz blanca contiene todas las frecuencias) y es mostrado en la~\autoref{fig::ruidoblanco32} para \(N=32\) y en la~\autoref{fig::ruidoblanco128} para \(N=256\) píxeles. En definitiva, se ajusta a una distribución de materia constituida por la localización aleatoria de partículas.

Con esta simulación se comprueba que el~\autoref{lst::script} funciona y se prosigue con el resto de las simulaciones.
\begin{figure}[h!]
    \centering
    {\input{pgf/ruidoblanco32.pgf}}
    \caption[Ruido blanco \(N=32\) píxeles]{Campo gaussiano aleatorio de ruido blanco \((n_s=0)\) con \(L=1\) Mpc/píxel y \(A_0=1\symrm{E}{-14}\) Mpc\textsuperscript{3}. Las fluctuaciones no guardan correlación entre sí haciendo que no aparezcan fluctuaciones sino píxeles sueltos con valores de \(\delta(\symbf{x})\) aleatorios.}
    \label{fig::ruidoblanco32}
\end{figure}
\begin{figure}[t!]
    \centering
    {\input{pgf/ruidoblanco128.pgf}}
    \caption[Ruido blanco \(N=256\) píxeles]{Campo gaussiano aleatorio de ruido blanco \((n_s=0)\) con \(L=1\) Mpc/píxel y \(A_0=1\symrm{E}{-18}\) Mpc\textsuperscript{3}. Con mayor número de píxeles se aprecia mejor el carácter de ruido blanco.}
    \label{fig::ruidoblanco128}
\end{figure}
\newpage
\subsection{Espectro \textit{blue-biased} (Harrison-Zel'dovich \texorpdfstring{\(n_s=1\)}{ns=1})}
En los casos \textit{blue-biased}, el espectro de potencias es monótono creciente ---para el de Harrison-Zel'dovich \(\symrm{P}_0(k)=k\). El significado de la afirmación anterior es que mientras mayor sea \(k\) (equiv. menor sea \(\lambda\)), mayor será la correlación entre las fluctuaciones de densidad en diferentes puntos espaciales, es decir, las fluctuaciones de pequeño tamaño predominan. El asociado \(\delta(\symbf{x})\) tiene un aspecto homogéneo pero con fluctuaciones de pequeño tamaño. El resultado es mostrado en la~\autoref{fig::bluebiased} para \(N=256\) píxeles.
%\begin{figure}
%    \centering
%    \scalebox{.835}{\input{pgf/bluetilted.pgf}}
%    \caption[Harrison-Zel'dovich \(N=256\) píxeles y \(L=4\) Mpc/píxel]{Campo gaussiano aleatorio Harrison-Zel'dovich con \(L=4\) Mpc/píxel. Se aprecia el carácter homogéneo de las fluctuaciones.}
%    \label{fig::bluebiased}
%\end{figure}
Si se amplía cualquier zona en la figura anterior, es posible apreciar como esas fluctuaciones son pequeñas pero notables (colores del mismo tono aparecen juntos) tal y como se vió en la~\autoref{sec::espectrolin}, en contraste al ruido blanco donde básicamente no se llegan a formar agrupaciones. Dicha amplificación se muestra en la misma figura.
\begin{figure}
    \centering
    \def\svgwidth{.94\textwidth}
    \input{svg/bluetilted.pdf_tex}
    \caption[Harrison-Zel'dovich \(N=256\) píxeles]{Campo gaussiano aleatorio Harrison-Zel'dovich \((n_s=1)\) con \(L=4\) Mpc/píxel y \(A_0=1\symrm{E}{-19}\) Mpc\textsuperscript{3}. Se aprecia el carácter homogéneo de las fluctuaciones.}
    \label{fig::bluebiased}
\end{figure}
%\begin{figure}
%    \centering
%    \scalebox{.85}{\input{pgf/bluetiltedzoom.pgf}}
%    \caption{Harrison-Zel'dovich \(N=256\) píxeles y \(L=4\) Mpc/píxel ampliado}
%    \label{fig::bluebiasedzoom}
%\end{figure}
\newpage
\subsection{Espectro \textit{red-biased} (\texorpdfstring{\(n_s=-3\)}{ns=-3})}
Esta categoría de espectros son la contraparte a los \textit{blue-biased} porque el espectro de potencias es monótono decreciente. Se obtiene que predominan las fluctuaciones de gran tamaño. El campo de fluctuaciones de la densidad que se obtiene es de baja homogeneidad. Dicho campo se muestra en la~\autoref{fig::redbiased} para \(N=512\) píxeles. Notar que no solo varían el tamaño de las fluctuaciones, sino la amplitud de estas. Al estar en un volumen del universo altamente heterogéneo, la amplitud de las fluctuaciones ha de ser mayor que en el caso homogéneo del espectro \textit{blue-biased} (por definición de homogeneidad). Para amplitudes \(\delta(\symbf{x})\sim 10^{-5}\), en el caso \textit{red-biased} son cinco veces mayores que en el espectro Harrison-Zel'dovich.
\begin{figure}[h!]
    \centering
    {\input{pgf/redtilted.pgf}}
    \caption[Espectro primordial \textit{red-biased} \(N=512\) píxeles]{Campo gaussiano aleatorio del espectro primordial \textit{red-biased} \((n_s=-3)\) con \(L=0.125\) Mpc/píxel y \(A_0=1\symrm{E}{-9}\) Mpc\textsuperscript{3}. Comienzan a aparecer fluctuaciones con forma de las estructuras que se observan en el universo.}
    \label{fig::redbiased}
\end{figure}
\clearpage
\section{Campos gaussianos con espectro de potencias en época de recombinación}
Ahora se añade al algoritmo, a través de la función de transferencia, el procesamiento que sufre el espectro de potencias primordial por la evolución gravitatoria de las fluctuaciones.
\subsection{Grandes escalas (\texorpdfstring{\(n_s=5\)}{ns=5})}
Como ya se vió en la~\autoref{sec::espectrolin} y en la~\autoref{fig::matterpower}, cuando los números de onda \(k\) son pequeños se tiene un espectro de potencias proporcional a \(k\). Al añadir la función de transferencia se coloca \(n_s=5\) para obtener el carácter proporcional a \(k\) deseado. El campo de fluctuaciones \(\delta(\symbf{x})\) que se obtenga ha de ser similar a uno \textit{blue-biased} donde las fluctuaciones son de pequeño tamaño. La realización se muestra en la~\autoref{fig::transfergrandes} para los mismos valores de \(N\) y \(L\) usados en la~\autoref{fig::bluebiased}. Se amplia la misma zona del campo para poder compararlas. Se encuentra gran similitud visual como se esperaba. La amplitud de las fluctuaciones, en cambio, es levemente mayor que en el caso del espectro primordial, pudiendo ser esto debido a la manera de colocar los valores en la barra de color del software.

Con este resultado se puede afirmar que la función de transferencia no tiene gran efecto en las fluctuaciones a grandes escalas (pequeños \(k\)), tal y como se esperaba.
\begin{figure}
    \centering
    \def\svgwidth{.94\textwidth}
    \input{svg/transfer.pdf_tex}
    \caption[Espectro en época de recombinación \(N=256\) píxeles]{Campo gaussiano aleatorio del espectro en época de recombinación \((n_s=5)\) con \(L=4\) Mpc/píxel y \(A_0=1\symrm{E}{-19}\) Mpc\textsuperscript{3}. Las fluctuaciones son homogéneas como se espera en grandes escalas.}
    \label{fig::transfergrandes}
\end{figure}
\clearpage
\subsection{Valores del CMB (\texorpdfstring{\(n_s=0.965\)}{ns=0.965})}
El último resultado que se presenta es el que más se acerca a lo observado por los radiotelescopios en el CMB. Incluyendo en la función de transferencia el valor medido en el fondo cósmico de microondas para el índice espectral \(n_s=0.965\), se obtiene un espectro de potencias de carácter \textit{red-biased}. En este caso, las fluctuaciones tienen que ser de gran tamaño. La imagen extraída se muestra en la~\autoref{fig::transfercmb} para \(N=512\) píxeles. La forma de las fluctuaciones se ve ``enfocada'' respecto de la~\autoref{fig::redbiased} por la influencia de la función de transferencia. Si se compara la~\autoref{fig::transfercmb} con el CMB de la~\autoref{fig::cmbpdf}, hay una gran similitud en el resultado con experimentos reales.
\begin{figure}[h!]
    \centering
    {\input{pgf/transfercmb.pgf}}
    \caption[Valores del CMB \(N=512\) píxeles]{Campo gaussiano aleatorio del espectro en época de recombinación \((n_s=0.965)\) con \(L=0.125\) Mpc/píxel y \(A_0=1\symrm{E}{-3}\) Mpc\textsuperscript{3}. Ahora la función de transferencia sí tiene un efecto notorio, suavizando la forma y bordes de las fluctuaciones.}
    \label{fig::transfercmb}
\end{figure}

Para obtener fluctuaciones del orden de \(10^{-5}\) se utiliza \(A_0=1\symrm{E}{-3}\) en este caso, lo cual significa que la función de transferencia disminuye la amplitud de las fluctuaciones en un valor considerable. Con este resultado es posible asegurar que la función de transferencia hace cuenta de los efectos gravitatorios que sienten las fluctuaciones en escalas pequeñas (grandes \(k\)), permitiendo la posterior evolución de las mismas en estructuras más complejas como galaxias o cúmulos.
\begin{figure}[t]
    \centering
    \includegraphics[scale=.6]{img/Planck_2018_Pol_CMB.pdf}
    \caption[Mapa del fondo cósmico de microondas suavizado]{Mapa del fondo cósmico de microondas suavizado (tomada de~\cite{collaboration2020planck4})}
    \label{fig::cmbpdf}
\end{figure}
\section{Campo gaussiano tridimensional con los valores del CMB}
Usando los mismos parámetros que para generar la~\autoref{fig::transfercmb}, se añade la tercera dimensión tomando diferentes cortes (se recorren las diferentes celdas de 0 a \(N\) en esta dimensión) y haciendo una animación con ellos generada a partir de usar un corte para cada fotograma, con un total de 52. El resultado se puede visualizar escaneando el código QR de la~\autoref{fig::qr}.
\begin{figure}[h]
    %{\hypersetup{urlcolor=.}\textcolor{qrblue}{\qrcode[height=.8in]{https://rafaariza.github.io/rafaariza/assets/images/FS2029FSC.gif}}}
    \centering
    \includegraphics[scale=.075]{svg/qrgif.pdf}
    \caption{Código QR de la animación tridimensional}
    \label{fig::qr}
\end{figure}

Lo que se aprecia en este resultado es que los cortes están relacionados entre sí cuando hay un desplazamiento por la caja tridimensional, observándose una conexión entre un corte y el inmediatamente anterior/posterior. Es decir, existe una correlación estadística en las fluctuaciones para diferentes valores espaciales. Como la elección de los ejes no es determinante en las simulaciones, dicha correlación espacial existe para las tres dimensiones como se esperaba que ocurriese.